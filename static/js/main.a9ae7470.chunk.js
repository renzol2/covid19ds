(this.webpackJsonprenzomledesma=this.webpackJsonprenzomledesma||[]).push([[0],{205:function(e,t,a){e.exports=a(348)},210:function(e,t,a){},211:function(e,t,a){},213:function(e,t,a){},348:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(89),o=a.n(c),l=(a(210),a(138)),i=a(24),u=a(9),s=(a(211),a(28)),m=a(18),p=a(72),d=a(17),f=a.n(d),h=a(90),b=a(187),E=a.n(b);var v=function(e){var t=Object(n.useState)(e),a=Object(u.a)(t,2),r=a[0],c=a[1],o=Object(n.useState)([]),l=Object(u.a)(o,2),i=l[0],s=l[1],m=Object(n.useState)([]),p=Object(u.a)(m,2),d=p[0],b=p[1],v=Object(n.useState)(!1),O=Object(u.a)(v,2),j=O[0],g=O[1],y=Object(n.useState)(!1),M=Object(u.a)(y,2),S=M[0],k=M[1];return Object(n.useEffect)((function(){(function(){var e=Object(h.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g(!0),k(!1);try{E.a.parse(r,{download:!0,header:!0,complete:function(e){e.errors.length>0&&e.errors.map((function(e){return console.log(e)})),s(e.data);var t=Object.keys(e.data[0]);t.shift(),b(t)}})}catch(t){console.log(t),k(!0)}g(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[r]),[{data:i,regions:d,isLoading:j,isError:S},c]},O=function(e){for(var t=e[0],a=e[0],n=e.length;n--;)isNaN(e[n])||(t=e[n]<t?e[n]:t,a=e[n]>a?e[n]:a);return{min:t,max:a}},j=function(e,t,a,n,r){return a+(n-a)*((r-e)/(t-e))};var g=function(e,t){for(var a=e,n=!1;!n;){var r=a%12;if(t.includes(r)){n=!0;break}n||a--}return a},y=a(48),M=a(33),S=(a(213),r.a.forwardRef((function(e,t){var a=e.children,n=e.onClick;return r.a.createElement(m.a,{href:"",ref:t,onClick:function(e){e.preventDefault(),n(e)}},a)}))),k=r.a.forwardRef((function(e,t){var a=e.children,c=e.style,o=e.className,l=e["aria-labelledby"],i=Object(n.useState)(""),s=Object(u.a)(i,2),m=s[0],p=s[1];return r.a.createElement("div",{ref:t,style:c,className:o,"aria-labelledby":l},r.a.createElement(y.a,{autoFocus:!0,className:"mx-3 my-2 w-auto",placeholder:"Type to filter...",onChange:function(e){return p(e.target.value)},value:m}),r.a.createElement("ul",{className:"list-unstyled"},r.a.Children.toArray(a).filter((function(e){return!m||e.props.children.toLowerCase().includes(m)}))))}));var w=function(e){var t=e.regions,a=e.callback,n=e.currentRegionName,c=function(e){a(e)},o=0;return r.a.createElement("div",null,r.a.createElement(M.a,{onSelect:function(e){c(t[e])}},r.a.createElement(M.a.Toggle,{as:S,id:"dropdown-custom-components"},"Region: ",r.a.createElement("b",null,n)),r.a.createElement(M.a.Menu,{as:k,className:"dropdown-scroll"},t.map((function(e){return r.a.createElement(M.a.Item,{eventKey:o++,key:o},e)})))))},C=a(15),x=a(13),N=a(92),I=a(31),T=a(30),D=function(e){Object(I.a)(a,e);var t=Object(T.a)(a);function a(e){var n;return Object(C.a)(this,a),(n=t.call(this,e)).handleChange=n.handleChange.bind(Object(N.a)(n)),n}return Object(x.a)(a,[{key:"handleChange",value:function(){var e=Object(h.a)(f.a.mark((function e(t){var a=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.setDataset(t),e.next=3,this.props.fetchData(t);case 3:setTimeout((function(){return a.props.initializeRegion(a.props.region)}),this.props.waitTime);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=0;return r.a.createElement(M.a,{onSelect:this.handleChange},r.a.createElement(M.a.Toggle,{id:"dropdown-basic"},"Data: ",r.a.createElement("b",null,this.props.currentDatasetName)),r.a.createElement(M.a.Menu,null,this.props.datasets.map((function(t){return r.a.createElement(M.a.Item,{eventKey:t.url,key:e++},t.title)}))))}}]),a}(n.Component),P=a(189);var R=function(e){var t=e.animate,a=e.axisLeft,n=e.data,c=e.onClick,o=e.onMouseMove;return r.a.createElement(P.a,{isInteractive:!0,enableArea:!0,useMesh:!0,animate:t,curve:"linear",enableGridY:!1,colors:{scheme:"dark2"},axisLeft:a,axisBottom:{legend:"Days since December 2019",legendOffset:40,format:function(e){return e%10===0?e:""}},margin:{top:20,bottom:50,left:60,right:20},data:n,onClick:c,onMouseMove:o,crosshairType:"cross",motionStiffness:300,motionDamping:40})},A=a(27),_=function(e){Object(I.a)(a,e);var t=Object(T.a)(a);function a(){return Object(C.a)(this,a),t.apply(this,arguments)}return Object(x.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(A.a,null,r.a.createElement(A.a.Prepend,null,r.a.createElement(A.a.Text,null,"Playback BPM")),r.a.createElement(y.a,{placeholder:"Ex: 200","aria-label":"BPM",onChange:function(t){return e.props.handleInput(t,e.props.setBpm)}})),r.a.createElement("p",null,"Current BPM: ",r.a.createElement("strong",null,this.props.bpm)))}}]),a}(n.Component),B=function(e){Object(I.a)(a,e);var t=Object(T.a)(a);function a(){return Object(C.a)(this,a),t.apply(this,arguments)}return Object(x.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(m.a,{variant:"primary",onClick:function(){return e.props.setOscSelection((e.props.oscSelection+1)%e.props.oscTypes.length)}},"Toggle oscillator")}}]),a}(n.Component),L=function(e){Object(I.a)(a,e);var t=Object(T.a)(a);function a(){return Object(C.a)(this,a),t.apply(this,arguments)}return Object(x.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(p.a,{"aria-label":"Increase/decrease pitch"},r.a.createElement(m.a,{variant:"secondary",onClick:function(){return e.props.setPitch(e.props.pitch-1)}},"Decrease pitch"),r.a.createElement(m.a,{variant:"secondary",onClick:function(){return e.props.setPitch(e.props.pitch+1)}},"Increase pitch"))}}]),a}(n.Component),z=function(e){Object(I.a)(a,e);var t=Object(T.a)(a);function a(){return Object(C.a)(this,a),t.apply(this,arguments)}return Object(x.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(A.a,null,r.a.createElement(A.a.Prepend,null,r.a.createElement(A.a.Text,null,"Minimum MIDI pitch")),r.a.createElement(y.a,{placeholder:"Ex: 0","aria-label":"Minimum MIDI pitch",onChange:function(t){return e.props.handleInput(t,e.props.setMinMidiPitch)}})),r.a.createElement(A.a,null,r.a.createElement(A.a.Prepend,null,r.a.createElement(A.a.Text,null,"Maximum MIDI pitch")),r.a.createElement(y.a,{placeholder:"Ex: 127","aria-label":"Maximum MIDI pitch",onChange:function(t){return e.props.handleInput(t,e.props.setMaxMidiPitch)}})))}}]),a}(n.Component),F=["sine","triangle","square","sawtooth"],W=[{name:"Chromatic",scale:[0,1,2,3,4,5,6,7,8,9,10,11]},{name:"Major",scale:[0,2,4,5,7,9,11]},{name:"Minor",scale:[0,2,3,5,7,8,10]},{name:"Pentatonic",scale:[0,2,4,7,9]},{name:"Whole tone",scale:[0,2,4,6,8,10]}],q="https://covid.ourworldindata.org/data/ecdc/total_cases.csv",G=[{title:"Total cases",url:"https://covid.ourworldindata.org/data/ecdc/total_cases.csv"},{title:"Total deaths",url:"https://covid.ourworldindata.org/data/ecdc/total_deaths.csv"},{title:"New cases",url:"https://covid.ourworldindata.org/data/ecdc/new_cases.csv"},{title:"New deaths",url:"https://covid.ourworldindata.org/data/ecdc/new_deaths.csv"}];var V=function(){var e=v(q),t=Object(u.a)(e,2),a=t[0],c=a.data,o=a.regions,d=a.isLoading,f=a.isError,h=t[1],b=Object(n.useState)(q),E=Object(u.a)(b,2),y=E[0],M=E[1],S=Object(n.useState)("World"),k=Object(u.a)(S,2),C=k[0],x=k[1],N=Object(n.useState)([]),I=Object(u.a)(N,2),T=I[0],P=I[1],A=Object(n.useState)(0),V=Object(u.a)(A,2),J=V[0],K=V[1],X=Object(n.useState)(0),U=Object(u.a)(X,2),Y=U[0],$=U[1],H=Object(n.useState)(!0),Q=Object(u.a)(H,2),Z=Q[0],ee=Q[1],te=Object(n.useState)(!0),ae=Object(u.a)(te,2),ne=ae[0],re=ae[1],ce=Object(n.useState)(Number.MAX_SAFE_INTEGER),oe=Object(u.a)(ce,2),le=oe[0],ie=oe[1],ue=Object(n.useState)(""),se=Object(u.a)(ue,2),me=se[0],pe=se[1],de=Object(n.useState)([]),fe=Object(u.a)(de,2),he=fe[0],be=fe[1],Ee=Object(n.useState)(60),ve=Object(u.a)(Ee,2),Oe=ve[0],je=ve[1],ge=Object(n.useState)(1),ye=Object(u.a)(ge,2),Me=ye[0],Se=ye[1],ke=Object(n.useState)(36),we=Object(u.a)(ke,2),Ce=we[0],xe=we[1],Ne=Object(n.useState)(96),Ie=Object(u.a)(Ne,2),Te=Ie[0],De=Ie[1],Pe=Object(n.useState)(999),Re=Object(u.a)(Pe,2),Ae=Re[0],_e=Re[1],Be=Object(n.useState)(0),Le=Object(u.a)(Be,2),ze=Le[0],Fe=Le[1],We=Object(n.useState)(!1),qe=Object(u.a)(We,2),Ge=qe[0],Ve=qe[1],Je=Object(n.useRef)(null);function Ke(e){console.log("init region"),x(e),function(e){var t,a=[],n=[],r=0,o=Object(i.a)(c);try{for(o.s();!(t=o.n()).done;){var l=t.value;a.push({date:l.date,amount:parseInt(l[e]),index:r++}),n.push(parseInt(l[e]))}}catch(s){o.e(s)}finally{o.f()}a.filter((function(e){return!isNaN(e.amount)})),P(a);var u=O(n.filter((function(e){return!isNaN(e)})));K(u.min),$(u.max)}(e)}function Xe(e){var t=j(J,Y,Ce,Te,e);return Math.floor(t)}function Ue(e){return e.filter((function(e){return!isNaN(e.amount)})).map((function(e){return{x:e.index,y:e.amount,color:e.amount===le?0:1}}))}function Ye(e){Je.current.triggerAttackRelease(s.Frequency(e,"midi"),"8n")}function $e(e,t){var a=parseInt(e.target.value);isNaN(a)||t(a)}return Object(n.useEffect)((function(){var e={oscillator:{type:F[Me]}};Je.current=new s.Synth(e).toMaster()})),Object(n.useEffect)((function(){T.length>0||Ke(C)})),r.a.createElement("div",{className:"body"},r.a.createElement("h1",null,"COVID-19 Data Sonification"),r.a.createElement("h3",null,"Display data:"),r.a.createElement("p",null,d?"Loading data...":null),r.a.createElement("p",null,f?"An error occurred.":null),r.a.createElement("p",null,"Min/max amount: ",J,"/",Y),r.a.createElement("p",null,"Current amount: ",le===Number.MAX_SAFE_INTEGER?"None":"".concat(le," cases at ").concat(me)),r.a.createElement("p",null,"Dataset URL: ",""===y?"None":y),r.a.createElement("h4",null,"Current region: ",C),r.a.createElement(p.a,null,r.a.createElement(w,{regions:o,callback:Ke,currentRegionName:C}),r.a.createElement(D,{currentDatasetName:G.find((function(e){return e.url===y})).title,datasets:G,setDataset:M,fetchData:h,region:C,initializeRegion:Ke,waitTime:600}),r.a.createElement(m.a,{onClick:function(){return ee(!Z)}},"Visualization: ".concat(Z?"on":"off")),r.a.createElement(m.a,{onClick:function(){return re(!ne)}},"Animation: ".concat(ne?"on":"off"))),0!==T.length&&r.a.createElement(p.a,null,r.a.createElement(m.a,{variant:"success",onClick:function(){s.Transport.cancel(),function(){Ve(!0),s.Transport.cancel();var e=T.map((function(e){return{note:Xe(e.amount),date:e.date,index:e.index}})).filter((function(e){return!isNaN(e.note)})).map((function(e){return Object(l.a)(Object(l.a)({},e),{},{note:g(e.note,W[ze].scale)})})),t=new s.Pattern((function(e,a){Je.current.triggerAttackRelease(s.Frequency(a.note,"midi"),.25),ie(T[a.index].amount),pe(a.date),he.push(T[a.index]),be(he),console.log(he),t.index===t.values.length-1&&(Ve(!1),be([]),s.Transport.cancel())}),e);t.start(0),s.Transport.bpm.value=Ae,s.Transport.start()}()}},"Play"),r.a.createElement(m.a,{variant:"danger",onClick:function(){s.Transport.cancel(),be([]),Ve(!1)}},"Stop")),r.a.createElement("div",{className:"dataViz"},Z&&r.a.createElement(R,{animate:ne,axisLeft:{legend:G.find((function(e){return e.url===y})).title,legendOffset:10,format:".2s"},data:[{id:C,data:Ue(Ge?he:T)}],onClick:function(e,t){void 0!==e&&Ye(g(Xe(e.data.y),W[ze].scale))},onMouseMove:function(e,t){void 0===e||Ge||(ie(e.data.y),pe(T[e.data.x].date))}})),r.a.createElement("h3",null,"Options:"),r.a.createElement(m.a,{variant:"info",onClick:function(){return Ye(Oe)}},"Play test pitch"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(L,{setPitch:je,pitch:Oe}),r.a.createElement("p",null,"The current MIDI pitch is: ",r.a.createElement("strong",null,Oe)),r.a.createElement(B,{setOscSelection:Se,oscSelection:Me,oscTypes:F}),r.a.createElement("p",null,"The current oscillator is: ",r.a.createElement("strong",null,F[Me])),r.a.createElement(m.a,{variant:"primary",onClick:function(){Fe((ze+1)%W.length)}},"Toggle scale"),r.a.createElement("p",null,"Scale: ",r.a.createElement("strong",null,W[ze].name)),r.a.createElement(z,{handleInput:$e,setMinMidiPitch:xe,setMaxMidiPitch:De}),r.a.createElement("p",null,"Min/max MIDI pitch: ",r.a.createElement("strong",null,"[",Ce,", ",Te,"]")),r.a.createElement(_,{bpm:Ae,setBpm:_e,handleInput:$e}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(347);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[205,1,2]]]);
//# sourceMappingURL=main.a9ae7470.chunk.js.map