(this.webpackJsonprenzomledesma=this.webpackJsonprenzomledesma||[]).push([[0],{209:function(e,t,a){e.exports=a(351)},214:function(e,t,a){},215:function(e,t,a){},217:function(e,t,a){},351:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(90),l=a.n(c),o=(a(214),a(140)),i=a(26),u=a(9),s=(a(215),a(18)),m=a(23),d=a(74),f=a(99),b=a(17),p=a.n(b),h=a(91),E=a(189),v=a.n(E);var O=function(e){var t=Object(n.useState)(e),a=Object(u.a)(t,2),r=a[0],c=a[1],l=Object(n.useState)([]),o=Object(u.a)(l,2),i=o[0],s=o[1],m=Object(n.useState)([]),d=Object(u.a)(m,2),f=d[0],b=d[1],E=Object(n.useState)(!1),O=Object(u.a)(E,2),j=O[0],g=O[1],y=Object(n.useState)(!1),S=Object(u.a)(y,2),M=S[0],k=S[1];return Object(n.useEffect)((function(){(function(){var e=Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g(!0),k(!1);try{v.a.parse(r,{download:!0,header:!0,complete:function(e){e.errors.length>0&&e.errors.map((function(e){return console.log(e)})),s(e.data);var t=Object.keys(e.data[0]);t.shift(),b(t)}})}catch(t){console.log(t),k(!0)}g(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[r]),[{data:i,regions:f,isLoading:j,isError:M},c]},j=function(e){for(var t=e[0],a=e[0],n=e.length;n--;)isNaN(e[n])||(t=e[n]<t?e[n]:t,a=e[n]>a?e[n]:a);return{min:t,max:a}},g=function(e,t,a,n,r){return a+(n-a)*((r-e)/(t-e))};var y=function(e,t){for(var a=e,n=!1;!n;){var r=a%12;if(t.includes(r)){n=!0;break}n||a--}return a},S=a(36),M=a(16),k=(a(217),r.a.forwardRef((function(e,t){var a=e.children,n=e.onClick;return r.a.createElement(m.a,{href:"",ref:t,onClick:function(e){e.preventDefault(),n(e)}},a)}))),w=r.a.forwardRef((function(e,t){var a=e.children,c=e.style,l=e.className,o=e["aria-labelledby"],i=Object(n.useState)(""),s=Object(u.a)(i,2),m=s[0],d=s[1];return r.a.createElement("div",{ref:t,style:c,className:l,"aria-labelledby":o},r.a.createElement(S.a,{autoFocus:!0,className:"mx-3 my-2 w-auto",placeholder:"Type to filter...",onChange:function(e){return d(e.target.value)},value:m}),r.a.createElement("ul",{className:"list-unstyled"},r.a.Children.toArray(a).filter((function(e){return!m||e.props.children.toLowerCase().includes(m)}))))}));var C=function(e){var t=e.regions,a=e.callback,n=e.currentRegionName,c=function(e){a(e)},l=0;return r.a.createElement("div",null,r.a.createElement(M.a,{onSelect:function(e){c(t[e])}},r.a.createElement(M.a.Toggle,{as:k,id:"dropdown-custom-components"},"Region: ",r.a.createElement("b",null,n)),r.a.createElement(M.a.Menu,{as:w,className:"dropdown-scroll"},t.map((function(e){return r.a.createElement(M.a.Item,{eventKey:l++,key:l},e)})))))},x=a(27),N=a(22),I=a(93),T=a(202),D=a(201),R=function(e){Object(T.a)(a,e);var t=Object(D.a)(a);function a(e){var n;return Object(x.a)(this,a),(n=t.call(this,e)).handleChange=n.handleChange.bind(Object(I.a)(n)),n}return Object(N.a)(a,[{key:"handleChange",value:function(){var e=Object(h.a)(p.a.mark((function e(t){var a=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.setDataset(t),e.next=3,this.props.fetchData(t);case 3:setTimeout((function(){return a.props.initializeRegion(a.props.region)}),this.props.waitTime);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=0;return r.a.createElement(M.a,{onSelect:this.handleChange},r.a.createElement(M.a.Toggle,{id:"dropdown-basic"},"Data: ",r.a.createElement("b",null,this.props.currentDatasetName)),r.a.createElement(M.a.Menu,null,this.props.datasets.map((function(t){return r.a.createElement(M.a.Item,{eventKey:t.url,key:e++},t.title)}))))}}]),a}(n.Component),P=a(191);var A=function(e){var t=e.animate,a=e.axisLeft,n=e.data,c=e.onClick,l=e.onMouseMove;return r.a.createElement(P.a,{isInteractive:!0,enableArea:!0,useMesh:!0,animate:t,curve:"linear",enableGridY:!1,colors:{scheme:"dark2"},axisLeft:a,axisBottom:{legend:"Days since December 31, 2019",legendOffset:40,format:function(e){return e%10===0?e:""}},margin:{top:20,bottom:50,left:60,right:50},data:n,onClick:c,onMouseMove:l,crosshairType:"cross",motionStiffness:300,motionDamping:40})},B=a(30);var L=function(e){var t=e.bpm,a=e.setBpm,n=e.handleInput;return r.a.createElement("div",null,r.a.createElement(B.a,null,r.a.createElement(B.a.Prepend,null,r.a.createElement(B.a.Text,null,"Playback BPM")),r.a.createElement(S.a,{placeholder:"Ex: 200","aria-label":"BPM",onChange:function(e){return n(e,a)}})),r.a.createElement("p",null,"Current BPM: ",r.a.createElement("strong",null,t)))};var _=function(e){var t=e.oscSelection,a=e.setOscSelection,n=e.oscTypes;return r.a.createElement(M.a,{onSelect:function(e){return a(e)}},r.a.createElement(M.a.Toggle,null,"Oscillator: ",r.a.createElement("b",null,t)),r.a.createElement(M.a.Menu,null,n.map((function(e){return r.a.createElement(M.a.Item,{eventKey:e,key:e},e)}))))};var F=function(e){var t=e.handleInput,a=e.setMinMidiPitch,n=e.setMaxMidiPitch;return r.a.createElement("div",null,r.a.createElement(B.a,null,r.a.createElement(B.a.Prepend,null,r.a.createElement(B.a.Text,null,"Minimum MIDI pitch")),r.a.createElement(S.a,{placeholder:"Ex: 0","aria-label":"Minimum MIDI pitch",onChange:function(e){return t(e,a)}})),r.a.createElement(B.a,null,r.a.createElement(B.a.Prepend,null,r.a.createElement(B.a.Text,null,"Maximum MIDI pitch")),r.a.createElement(S.a,{placeholder:"Ex: 127","aria-label":"Maximum MIDI pitch",onChange:function(e){return t(e,n)}})))};var z=function(e){var t=e.scales,a=e.scaleSelection,n=e.setScaleSelection;return r.a.createElement(M.a,{onSelect:function(e){n(e)}},r.a.createElement(M.a.Toggle,null,"Scale: ",r.a.createElement("b",null,t[a].name)),r.a.createElement(M.a.Menu,null,Object.values(t).map((function(e){return r.a.createElement(M.a.Item,{eventKey:e.key,key:e.key},e.name)}))))},W=["sine","triangle","square","sawtooth"],V={chromatic:{key:"chromatic",name:"Chromatic",scale:[0,1,2,3,4,5,6,7,8,9,10,11]},major:{key:"major",name:"Major",scale:[0,2,4,5,7,9,11]},minor:{key:"minor",name:"Minor",scale:[0,2,3,5,7,8,10]},pentatonic:{key:"pentatonic",name:"Pentatonic",scale:[0,2,4,7,9]},wholeTone:{key:"wholeTone",name:"Whole tone",scale:[0,2,4,6,8,10]}},J="https://covid.ourworldindata.org/data/ecdc/total_cases.csv",K=[{title:"Total cases",url:"https://covid.ourworldindata.org/data/ecdc/total_cases.csv"},{title:"Total deaths",url:"https://covid.ourworldindata.org/data/ecdc/total_deaths.csv"},{title:"New cases",url:"https://covid.ourworldindata.org/data/ecdc/new_cases.csv"},{title:"New deaths",url:"https://covid.ourworldindata.org/data/ecdc/new_deaths.csv"}];var q=function(){var e=O(J),t=Object(u.a)(e,2),a=t[0],c=a.data,l=a.regions,b=a.isLoading,p=a.isError,h=t[1],E=Object(n.useState)(J),v=Object(u.a)(E,2),S=v[0],M=v[1],k=Object(n.useState)("World"),w=Object(u.a)(k,2),x=w[0],N=w[1],I=Object(n.useState)([]),T=Object(u.a)(I,2),D=T[0],P=T[1],B=Object(n.useState)(0),q=Object(u.a)(B,2),G=q[0],X=q[1],Q=Object(n.useState)(0),U=Object(u.a)(Q,2),Y=U[0],$=U[1],H=Object(n.useState)(!0),Z=Object(u.a)(H,2),ee=Z[0],te=Z[1],ae=Object(n.useState)(!0),ne=Object(u.a)(ae,2),re=ne[0],ce=ne[1],le=Object(n.useState)(Number.MAX_SAFE_INTEGER),oe=Object(u.a)(le,2),ie=oe[0],ue=oe[1],se=Object(n.useState)(""),me=Object(u.a)(se,2),de=me[0],fe=me[1],be=Object(n.useState)([]),pe=Object(u.a)(be,2),he=pe[0],Ee=pe[1],ve=Object(n.useState)(-5),Oe=Object(u.a)(ve,2),je=Oe[0],ge=Oe[1],ye=Object(n.useState)("triangle"),Se=Object(u.a)(ye,2),Me=Se[0],ke=Se[1],we=Object(n.useState)(36),Ce=Object(u.a)(we,2),xe=Ce[0],Ne=Ce[1],Ie=Object(n.useState)(96),Te=Object(u.a)(Ie,2),De=Te[0],Re=Te[1],Pe=Object(n.useState)(999),Ae=Object(u.a)(Pe,2),Be=Ae[0],Le=Ae[1],_e=Object(n.useState)("chromatic"),Fe=Object(u.a)(_e,2),ze=Fe[0],We=Fe[1],Ve=Object(n.useState)(!1),Je=Object(u.a)(Ve,2),Ke=Je[0],qe=Je[1],Ge=Object(n.useState)(!1),Xe=Object(u.a)(Ge,2),Qe=Xe[0],Ue=Xe[1],Ye=Object(n.useState)(!1),$e=Object(u.a)(Ye,2),He=$e[0],Ze=$e[1],et=Object(n.useState)(!1),tt=Object(u.a)(et,2),at=tt[0],nt=tt[1],rt=Object(n.useState)(!1),ct=Object(u.a)(rt,2),lt=ct[0],ot=ct[1],it=Object(n.useState)(!1),ut=Object(u.a)(it,2),st=ut[0],mt=ut[1],dt=Object(n.useRef)(null);function ft(e){N(e),function(e){var t,a=[],n=[],r=0,l=Object(i.a)(c);try{for(l.s();!(t=l.n()).done;){var o=t.value;a.push({date:o.date,amount:parseInt(o[e]),index:r++}),n.push(parseInt(o[e]))}}catch(s){l.e(s)}finally{l.f()}a.filter((function(e){return!isNaN(e.amount)})),P(a);var u=j(n.filter((function(e){return!isNaN(e)})));X(u.min),$(u.max)}(e)}function bt(e){var t=g(G,Y,xe,De,e);return Math.floor(t)}function pt(e){return e.filter((function(e){return!isNaN(e.amount)})).map((function(e){return{x:e.index,y:e.amount,color:e.amount===ie?0:1}}))}function ht(e,t){var a=parseInt(e.target.value);isNaN(a)||t(a)}return Object(n.useEffect)((function(){var e={oscillator:{type:Me,volume:je}},t=new s.Distortion(1).toMaster(),a=new s.JCReverb(.5).toMaster(),n=new s.Freeverb(.75).toMaster(),r=new s.Chorus(4,2.5,.5).toMaster(),c=new s.AutoWah(50,6,-30).toMaster();c.Q.value=10,dt.current=new s.Synth(e),He&&dt.current.connect(t),Qe&&dt.current.connect(r),lt&&dt.current.connect(n),at&&dt.current.connect(a),st&&dt.current.connect(c),dt.current.toMaster()}),[Me,je,He,Qe,lt,at,st]),Object(n.useEffect)((function(){D.length>0||ft(x)})),r.a.createElement("div",{className:"body"},r.a.createElement("h1",null,"COVID-19 Data Sonification"),r.a.createElement("h3",null,"Display data:"),r.a.createElement("p",null,b?"Loading data...":null),r.a.createElement("p",null,p?"An error occurred.":null),r.a.createElement("p",null,"Min/max amount: ",G,"/",Y),r.a.createElement("p",null,"Current amount: ",ie===Number.MAX_SAFE_INTEGER?"None":"".concat(ie," cases at ").concat(de)),r.a.createElement("p",null,"Dataset URL: ",""===S?"None":S),r.a.createElement("h4",null,"Current region: ",x),r.a.createElement(d.a,null,r.a.createElement(C,{regions:l,callback:ft,currentRegionName:x}),r.a.createElement(R,{currentDatasetName:K.find((function(e){return e.url===S})).title,datasets:K,setDataset:M,fetchData:h,region:x,initializeRegion:ft,waitTime:600}),r.a.createElement(m.a,{onClick:function(){return te(!ee)}},"Visualization: ".concat(ee?"on":"off")),r.a.createElement(m.a,{onClick:function(){return ce(!re)}},"Animation: ".concat(re?"on":"off"))),0!==D.length&&r.a.createElement(d.a,null,r.a.createElement(m.a,{variant:"success",onClick:function(){s.Transport.cancel(),function(){qe(!0),s.Transport.cancel();var e=D.map((function(e){return{note:bt(e.amount),date:e.date,index:e.index}})).filter((function(e){return!isNaN(e.note)})).map((function(e){return Object(o.a)(Object(o.a)({},e),{},{note:y(e.note,V[ze].scale)})})),t=new s.Pattern((function(e,a){dt.current.triggerAttackRelease(s.Frequency(a.note,"midi"),.25),ue(D[a.index].amount),fe(a.date),he.push(D[a.index]),Ee(he),t.index===t.values.length-1&&(qe(!1),Ee([]),s.Transport.cancel())}),e);t.start(0),s.Transport.bpm.value=Be,s.Transport.start()}()}},"Play"),r.a.createElement(m.a,{variant:"danger",onClick:function(){s.Transport.cancel(),Ee([]),qe(!1)}},"Stop")),r.a.createElement("div",{className:"dataViz"},ee&&r.a.createElement(A,{animate:re,axisLeft:{legend:K.find((function(e){return e.url===S})).title,legendOffset:10,format:".2s"},data:[{id:x,data:pt(Ke?he:D)}],onClick:function(e,t){var a;void 0!==e&&(a=y(bt(e.data.y),V[ze].scale),dt.current.triggerAttackRelease(s.Frequency(a,"midi"),"8n"))},onMouseMove:function(e,t){void 0===e||Ke||(ue(e.data.y),fe(D[e.data.x].date))}})),r.a.createElement("h3",null,"Options:"),r.a.createElement(f.a,null,r.a.createElement(f.a.Label,null,"Synth Volume (in dB)"),r.a.createElement(f.a.Control,{type:"range",defaultValue:g(-30,0,0,100,-5),onChange:function(e){var t=e.target.value,a=g(0,100,-30,0,t);ge(a)}})),r.a.createElement(d.a,null,r.a.createElement(_,{setOscSelection:ke,oscSelection:Me,oscTypes:W}),r.a.createElement(z,{scales:V,scaleSelection:ze,setScaleSelection:We})),r.a.createElement("br",null),r.a.createElement(d.a,null,r.a.createElement(m.a,{variant:He?"primary":"outline-primary",onClick:function(){return Ze(!He)}},"Distortion: ",r.a.createElement("b",null,He?"enabled":"disabled")),r.a.createElement(m.a,{variant:Qe?"primary":"outline-primary",onClick:function(){return Ue(!Qe)}},"Chorus: ",r.a.createElement("b",null,Qe?"enabled":"disabled")),r.a.createElement(m.a,{variant:lt?"primary":"outline-primary",onClick:function(){return ot(!lt)}},"Freeverb: ",r.a.createElement("b",null,lt?"enabled":"disabled")),r.a.createElement(m.a,{variant:at?"primary":"outline-primary",onClick:function(){return nt(!at)}},"JCReverb: ",r.a.createElement("b",null,at?"enabled":"disabled")),r.a.createElement(m.a,{variant:st?"primary":"outline-primary",onClick:function(){return mt(!st)}},"AutoWah: ",r.a.createElement("b",null,st?"enabled":"disabled"))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(F,{handleInput:ht,setMinMidiPitch:Ne,setMaxMidiPitch:Re}),r.a.createElement("p",null,"Min/max MIDI pitch: ",r.a.createElement("strong",null,"[",xe,", ",De,"]")),r.a.createElement(L,{bpm:Be,setBpm:Le,handleInput:ht}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(350);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[209,1,2]]]);
//# sourceMappingURL=main.d3583b33.chunk.js.map